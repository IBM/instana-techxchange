"use strict";(self.webpackChunkinstana_techxchange=self.webpackChunkinstana_techxchange||[]).push([[813],{3905:(t,e,n)=>{n.d(e,{Zo:()=>p,kt:()=>d});var a=n(67294);function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function r(t,e){if(null==t)return{};var n,a,o=function(t,e){if(null==t)return{};var n,a,o={},i=Object.keys(t);for(a=0;a<i.length;a++)n=i[a],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)n=i[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}var l=a.createContext({}),c=function(t){var e=a.useContext(l),n=e;return t&&(n="function"==typeof t?t(e):s(s({},e),t)),n},p=function(t){var e=c(t.components);return a.createElement(l.Provider,{value:e},t.children)},h="mdxType",u={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},g=a.forwardRef((function(t,e){var n=t.components,o=t.mdxType,i=t.originalType,l=t.parentName,p=r(t,["components","mdxType","originalType","parentName"]),h=c(n),g=o,d=h["".concat(l,".").concat(g)]||h[g]||u[g]||i;return n?a.createElement(d,s(s({ref:e},p),{},{components:n})):a.createElement(d,s({ref:e},p))}));function d(t,e){var n=arguments,o=e&&e.mdxType;if("string"==typeof t||o){var i=n.length,s=new Array(i);s[0]=g;var r={};for(var l in e)hasOwnProperty.call(e,l)&&(r[l]=e[l]);r.originalType=t,r[h]="string"==typeof t?t:o,s[1]=r;for(var c=2;c<i;c++)s[c]=n[c];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},38225:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>i,metadata:()=>r,toc:()=>c});var a=n(87462),o=(n(67294),n(3905));const i={title:"6. Action Catalog",description:"Welcome to the Synthetic Monitoring and Action Catalog lab",sidebar_position:60},s="Action Catalog",r={unversionedId:"instana-v2/synthetic-pop/action-catalog/index",id:"instana-v2/synthetic-pop/action-catalog/index",title:"6. Action Catalog",description:"Welcome to the Synthetic Monitoring and Action Catalog lab",source:"@site/labs/instana-v2/synthetic-pop/6-action-catalog/index.mdx",sourceDirName:"instana-v2/synthetic-pop/6-action-catalog",slug:"/instana-v2/synthetic-pop/action-catalog/",permalink:"/instana-techxchange/labs/instana-v2/synthetic-pop/action-catalog/",draft:!1,editUrl:"https://github.com/IBM/instana-techxchange/tree/main/labs/instana-v2/synthetic-pop/6-action-catalog/index.mdx",tags:[],version:"current",sidebarPosition:60,frontMatter:{title:"6. Action Catalog",description:"Welcome to the Synthetic Monitoring and Action Catalog lab",sidebar_position:60},sidebar:"tutorialSidebar",previous:{title:"5. Smart Alert",permalink:"/instana-techxchange/labs/instana-v2/synthetic-pop/smart-alert/"},next:{title:"7. Summary",permalink:"/instana-techxchange/labs/instana-v2/synthetic-pop/summary/"}},l={},c=[],p={toc:c},h="wrapper";function u(t){let{components:e,...i}=t;return(0,o.kt)(h,(0,a.Z)({},p,i,{components:e,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"action-catalog"},"Action Catalog"),(0,o.kt)("p",null,"Instana recently added a capability called the ",(0,o.kt)("strong",{parentName:"p"},"Action Catalog"),".  The ",(0,o.kt)("strong",{parentName:"p"},"Action Catalog")," allows you to execute corrective actions in order to solve problems in an automated way.  "),(0,o.kt)("p",null,"The approach allows you to reduce downtime by fixing known issues as quickly as possible. There is no need to leave the Instana user interface. In the near future, you will also be able to have those\nautomated actions execute automatically whenever specific Events trigger."),(0,o.kt)("p",null,"An example might be that when the log file of an application has consumed all available disk space, SREs may restore service by deleteing logs or extending space with one click from Instana UI."),(0,o.kt)("p",null,"There are multiple ways to execute the Actions. Instana can be integrated with tools like Ansible to execute complex automations remotely. It supports the execution of webhooks.",(0,o.kt)("br",{parentName:"p"}),"\n","It supports the integration of web pages so that you can point to a manual runbook.  And, it provides the ability to execute scripts locally on the Agent machine."),(0,o.kt)("p",null,"In the lab we will create an action that SRE can run from the context of a raised event."),(0,o.kt)("p",null,'Click on Automation from the left menu, select "Action catalog" and then "New Action"\n',(0,o.kt)("img",{src:n(77334).Z,width:"2300",height:"1420"})),(0,o.kt)("p",null,"Define ",(0,o.kt)("strong",{parentName:"p"},"Name")," and ",(0,o.kt)("strong",{parentName:"p"},"Description")," for the ",(0,o.kt)("strong",{parentName:"p"},"Action")),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(45837).Z,width:"1898",height:"1158"})),(0,o.kt)("p",null,"Notice that the ",(0,o.kt)("strong",{parentName:"p"},"Action Catalog")," supports ",(0,o.kt)("strong",{parentName:"p"},"Tags"),".  In this lab we will not be using tags."),(0,o.kt)("p",null,"Select the Action ",(0,o.kt)("strong",{parentName:"p"},"Type")," dropdown and choose the ",(0,o.kt)("strong",{parentName:"p"},"Script")," option.  Notice that there are a few other options.  The ",(0,o.kt)("strong",{parentName:"p"},"Documentation Link")," is used to associate a manual runbook into Instana.  The ",(0,o.kt)("strong",{parentName:"p"},"HTTP")," option is used to automate the execution of a REST API call."),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(94811).Z,width:"1188",height:"231"})),(0,o.kt)("p",null,"Next, add your shell script content to the section labeled ",(0,o.kt)("strong",{parentName:"p"},"Script"),".  Paste in the content shown below."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/bash\necho `date` " - Deleting old log files" >> /tmp/action.txt\n')),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"You'll notice that this script doesn't really delete any files, but it gives you some ideas of what can be done.")),(0,o.kt)("p",null,"The results should look as follows:"),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(5499).Z,width:"593",height:"406"})),(0,o.kt)("p",null,"We won't be using it in this lab, but notice that there is a ",(0,o.kt)("strong",{parentName:"p"},"Parameters")," section of the ",(0,o.kt)("strong",{parentName:"p"},"Action")," where you can pass parameters into your script."),(0,o.kt)("p",null,"In the next section, you will decide which Events will be associated with your automation.  The idea is that you only want your automation to appear when certain Events trigger."),(0,o.kt)("p",null,"Notice that there are two categories of Events. There are traditional static ",(0,o.kt)("strong",{parentName:"p"},"Events")," and there are ",(0,o.kt)("strong",{parentName:"p"},"Smart Alerts"),". You have an opportunity to associate the automation/Action with both types of Events."),(0,o.kt)("p",null,"Click on ",(0,o.kt)("strong",{parentName:"p"},"Add Events"),". "),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(64621).Z,width:"930",height:"273"})),(0,o.kt)("p",null,"Then, filter the Events by specifying ",(0,o.kt)("strong",{parentName:"p"},"Host")," (1) for the ",(0,o.kt)("strong",{parentName:"p"},"Entity Type"),", then specifying ",(0,o.kt)("strong",{parentName:"p"},"disk")," in the ",(0,o.kt)("strong",{parentName:"p"},"Filter Events")," field."),(0,o.kt)("p",null,"You should now see a list of 3 disk space related Events.   Click the checkbox to select all three.  Then, click the ",(0,o.kt)("strong",{parentName:"p"},"Add 3 Events")," button."),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(42365).Z,width:"1509",height:"673"})),(0,o.kt)("p",null,"Now, we can add some ",(0,o.kt)("strong",{parentName:"p"},"Smart Alerts")," to associate with our ",(0,o.kt)("strong",{parentName:"p"},"Action"),".  "),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(81127).Z,width:"927",height:"294"})),(0,o.kt)("p",null,"Let's assume that we have high erroneous calls due to the filesystem filling up.  Select the ",(0,o.kt)("strong",{parentName:"p"},"Smart Alert")," named ",(0,o.kt)("strong",{parentName:"p"},"Erroneous call rate is higher than normal")),(0,o.kt)("p",null,"Then, click the ",(0,o.kt)("strong",{parentName:"p"},"Select 1 Smart Alert")," button at the bottom of the page."),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(29893).Z,width:"1373",height:"769"})),(0,o.kt)("p",null,"Finally, at the bottom of the page, click the ",(0,o.kt)("strong",{parentName:"p"},"Create")," button to create your Action."),(0,o.kt)("p",null,"By default, the Instana Agents will not allow you to execute Actions.  This features must be enabled on each Agent where you want to execute Actions.  This is done by editing the ",(0,o.kt)("inlineCode",{parentName:"p"},"configuration.yaml")," file for the agent."),(0,o.kt)("p",null,"Login to ",(0,o.kt)("strong",{parentName:"p"},"Infranfs")," node using ssh terminal as root."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"ssh root@10.100.1.2\n")),(0,o.kt)("p",null,"Edit configuration.yaml file of the agent:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"vi /opt/instana/agent/etc/instana/configuration.yaml\n")),(0,o.kt)("p",null,"Enable Actions plugin by adding the following config block in the end of the file:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-yml"},"# Action Catalog\ncom.instana.plugin.action.script:\n  enabled: true    # by default is false\n  scriptExecutionHome: /tmp\n  runAs: mqm\n")),(0,o.kt)("p",null,"Notice that you can specify any directory where you want the script to execute.   And, you can specify the user account that you want the script to run-as.   In this case, the infrafs server is an MQ server, so we are going to run the script as the MQ admin account."),(0,o.kt)("p",null,"Save end exit from file."),(0,o.kt)("p",null,"Go back to the Instana user interface.  Within the Action Catalog, you will see your Action.  Notice that you can manually execute the Action by selecting the run arrow."),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(93450).Z,width:"1792",height:"203"})),(0,o.kt)("p",null,"In addition, the Action has now been associated with the 4 Events/Smart Alerts that you selected.   "),(0,o.kt)("p",null,'Get back to Instana dashboard and open Events -> Issues:\nChoose issue "Erroneous call rate too high":\n',(0,o.kt)("img",{src:n(13559).Z,width:"1572",height:"902"})),(0,o.kt)("p",null,'Scroll down, see associated actions with the event and click "Run" on the Associated Action "Delete old log files":\n',(0,o.kt)("img",{src:n(88150).Z,width:"1604",height:"774"})),(0,o.kt)("p",null,'Select Agent on which to run the command and click "Run Action":\n',(0,o.kt)("img",{src:n(71611).Z,width:"1464",height:"912"})),(0,o.kt)("p",null,"To ensure the script has been executed login to Infranfs node using ssh terminal as root."),(0,o.kt)("p",null,"Check content of the file ",(0,o.kt)("inlineCode",{parentName:"p"},"/tmp/action.txt")," on the infranfs node:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"cat /tmp/action.txt\n")),(0,o.kt)("p",null,"The results should look similar to the image below:\n",(0,o.kt)("img",{src:n(11574).Z,width:"1946",height:"132"})))}u.isMDXComponent=!0},45837:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/ActionCatalog_ActionDetails-01703f9db6c18a982f3a0309ee602b2e.png"},13559:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/ActionCatalog_Event-606df045b8b308cd377c5385d335b018.png"},11574:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/ActionCatalog_Results-1cdc5e62229999b7e273d640fa215be3.png"},88150:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/ActionCatalog_RunAction-ddfd9f72153cf21e210578b76079f7f4.png"},71611:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/ActionCatalog_SelectAgent-3e53320ff46919e2c52aec28ab001f00.png"},77334:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/ActionCatalog_new-b6f468d175e82ec641e3d36aef470419.png"},42365:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/addEvents-b2c9695287133f34b9a2587307d81639.png"},29893:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/addSmartAlert2-d233d82034eff4ef80bd990412e0470f.png"},5499:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/bashScript-d44f651e55af154d46670a863b783d77.png"},64621:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/instana-actions-add-event-bb2b163023fc7998da68160ceffa6b09.png"},81127:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/instana-actions-add-smart-06e307a7c19d5dd7c4bf8b21fc126307.png"},93450:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/manuallyExecute-b29020c758d0a03232eae25095784597.png"},94811:(t,e,n)=>{n.d(e,{Z:()=>a});const a=n.p+"assets/images/selectScript-544c627cfff6e6eeeeace08b4ee97f54.png"}}]);