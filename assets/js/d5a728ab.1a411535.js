"use strict";(self.webpackChunkinstana_techxchange=self.webpackChunkinstana_techxchange||[]).push([[543],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var a=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var o=a.createContext({}),c=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(o.Provider,{value:t},e.children)},u="mdxType",g={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,o=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=c(n),m=i,h=u["".concat(o,".").concat(m)]||u[m]||g[m]||r;return n?a.createElement(h,l(l({ref:t},p),{},{components:n})):a.createElement(h,l({ref:t},p))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,l=new Array(r);l[0]=m;var s={};for(var o in t)hasOwnProperty.call(t,o)&&(s[o]=t[o]);s.originalType=e,s[u]="string"==typeof e?e:i,l[1]=s;for(var c=2;c<r;c++)l[c]=n[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},44598:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>g,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var a=n(87462),i=(n(67294),n(3905));const r={title:"1. Instana agent installation",description:"Install the Instana agent on OCP cluster",sidebar_position:4},l="Instana agent installation",s={unversionedId:"instana-v2/opentelemetry/agent-installation/index",id:"instana-v2/opentelemetry/agent-installation/index",title:"1. Instana agent installation",description:"Install the Instana agent on OCP cluster",source:"@site/labs/instana-v2/opentelemetry/3-agent-installation/index.mdx",sourceDirName:"instana-v2/opentelemetry/3-agent-installation",slug:"/instana-v2/opentelemetry/agent-installation/",permalink:"/instana-techxchange/labs/instana-v2/opentelemetry/agent-installation/",draft:!1,editUrl:"https://github.com/IBM/instana-techxchange/tree/main/labs/instana-v2/opentelemetry/3-agent-installation/index.mdx",tags:[],version:"current",sidebarPosition:4,frontMatter:{title:"1. Instana agent installation",description:"Install the Instana agent on OCP cluster",sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Synthetic Monitoring and Action Catalog",permalink:"/instana-techxchange/labs/instana-v2/synthetic-pop/"},next:{title:"2. OpenTelemetry instrumentation",permalink:"/instana-techxchange/labs/instana-v2/opentelemetry/opentelemetry-instrumentation/"}},o={},c=[{value:"Environment login",id:"environment-login",level:2},{value:"Helm chart",id:"helm-chart",level:2},{value:"Verify Kubernetes monitoring",id:"verify-kubernetes-monitoring",level:2}],p={toc:c},u="wrapper";function g(e){let{components:t,...r}=e;return(0,i.kt)(u,(0,a.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"instana-agent-installation"},"Instana agent installation"),(0,i.kt)("p",null,"In this section you will install Instana Agent to monitor your Kubernetes cluster."),(0,i.kt)("h2",{id:"environment-login"},"Environment login"),(0,i.kt)("p",null,"Open your Student virtual machine, open Terminal, use ssh to connect to the Bastion node. You will need the Terminal later during the lab."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"agent4",src:n(15199).Z,width:"1212",height:"701"})),(0,i.kt)("h2",{id:"helm-chart"},"Helm chart"),(0,i.kt)("p",null,"Open the Firefox browser, click on the Instana bookmark and log in to your Instana UI. "),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"agent5",src:n(84143).Z,width:"923",height:"785"})),(0,i.kt)("p",null,'When opening the browser, you may receive a security warning.   If you do, click the "Advanced" button.'),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"agent5",src:n(82782).Z,width:"877",height:"258"})),(0,i.kt)("p",null,'Then, select "Accept the Risk and Continue"'),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"agent5",src:n(72303).Z,width:"802",height:"297"})),(0,i.kt)("p",null,'Then, click "Sign In" to log into the Instana user interface.'),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"agent5",src:n(54839).Z,width:"478",height:"478"})),(0,i.kt)("p",null,'Click on the "Stan" icon in the upper left corner (1). Then, Click on the "Deploy agent" link (2) as shown below.'),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"agent1",src:n(95440).Z,width:"1267",height:"580"})),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},'In the "Install Agents" dialog, select "Kubernetes" (1).'),(0,i.kt)("li",{parentName:"ul"},'Then, choose the "Helm chart" installation option (2). '),(0,i.kt)("li",{parentName:"ul"},'Enter a Cluster Name (3).  In the example, we have specified "kube-cluster".'),(0,i.kt)("li",{parentName:"ul"},'Enter a Zone Name such as "kube-zone" (4).  '),(0,i.kt)("li",{parentName:"ul"},"Finally, copy the helm chart installation script (5).")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"agent2",src:n(23530).Z,width:"835",height:"435"})),(0,i.kt)("p",null,"Go back to your Terminal console, ssh to your Kubernetes cluster by typing:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"ssh root@10.100.1.60\n")),(0,i.kt)("p",null,"When prompted, enter the root password."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"agent7",src:n(69869).Z,width:"1386",height:"720"})),(0,i.kt)("p",null,"paste the copied helm chart installation script and hit enter"),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},'DO NOT copy the example shown below. It does not contain a valid downloadKey and agent.key. This information must be obtained from your Instana server.\nNotice that agent.key, agen.downloadKey, and agent.endpointHost are "xxx".  You values must be copied from the Instana UI so that they match your environment.')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"helm install instana-agent \\\n   --repo https://agents.instana.io/helm \\\n   --namespace instana-agent \\\n   --create-namespace \\\n   --set agent.key=xxx \\\n   --set agent.downloadKey=xxx \\\n   --set agent.endpointHost=xxx \\\n   --set agent.endpointPort=443 \\\n   --set cluster.name='kube-cluster' \\\n   --set zone.name='kube-zone' \\\n   instana-agent\n")),(0,i.kt)("p",null,"Make sure the installation was completed successfully by checking the below command output"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sh"},"kubectl get all -n instana-agent\n\nNAME                        READY   STATUS    RESTARTS   AGE\ninstana-agent-xxx           1/1     Running   0          27h\nk8sensor-xxx-6rddc          1/1     Running   0          3d\nk8sensor-xxx-btll6          1/1     Running   0          3d\nk8sensor-xxx-qvn2s          1/1     Running   0          3d\n")),(0,i.kt)("h2",{id:"verify-kubernetes-monitoring"},"Verify Kubernetes monitoring"),(0,i.kt)("p",null,'Go to your Instana UI, click on "Kubernetes" left side menu. Ensure you are getting the metrics from your cluster.'),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"agent8",src:n(95796).Z,width:"1692",height:"529"})))}g.isMDXComponent=!0},95440:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/agent-install-001-fixed-86a66b1645ad5d7c354044e1ba7c8e4b.png"},15199:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/agent-install-004-3a289e809f5b1ca8922057d298271c26.png"},84143:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/agent-install-005-fixed-91b57c622497fef5d144507694493379.png"},69869:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/agent-install-007-3008b37c968d8701a1336476762f80b7.png"},95796:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/agent-install-008-fixed-9f5674dd655e310d949eeea591d31b2e.png"},23530:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/helmChart-a8ec06f1022041cd693b45ec0149f646.png"},82782:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/securityRisk-ab8dcdff89e956e8e713f43186a4b043.png"},72303:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/securityRisk2-e20ca87357ee4b5400d3e64a6124160b.png"},54839:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/signIn-2cc90a915b410155a801bbe7f6c62a7b.png"}}]);